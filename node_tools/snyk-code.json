{"$schema": "https://docs.oasis-open.org/sarif/sarif/v2.1.0/errata01/os/schemas/sarif-schema-2.1.0.json","version": "2.1.0","runs": [{"tool": {"driver" : {"name" : "SnykCode","semanticVersion" : "1.1300.2","version" : "1.1300.2","informationUri" : "https://docs.snyk.io/","rules" : [{"id": "javascript/DOMXSS","name": "DOMXSS","shortDescription": {"text": "DOM-based Cross-site Scripting (XSS)"},"defaultConfiguration": {"level": "warning"},"help": {"markdown": "## Details\n\nDOM-based Cross-Site Scripting (DOM XSS) is a client-side vulnerability in which attacker-controlled data (e.g., from `location.search`, `location.hash`, `document.referrer`, browser storage, `postMessage`, WebSockets) is read by JavaScript and written to dangerous DOM/JS sinks without proper validation or encoding, causing code to execute entirely in the browser. The payload may be delivered by the server or other channels, but—unlike reflected or stored XSS—the server does not perform the injection/echo that triggers execution; the critical issue is a tainted data flow from source to sink within client-side logic, which traditional server-side defenses and many WAFs often miss.\n\nEffective mitigation of DOM XSS vulnerabilities requires implementing comprehensive input validation and output encoding strategies specifically designed for client‑side execution contexts. This includes establishing strict allowlisting mechanisms for user‑controllable data, implementing context‑aware output encoding based on the specific DOM operation being performed, and adopting secure coding practices that minimize the attack surface exposed through dangerous DOM/JavaScript APIs. Additionally, modern web applications should leverage Content Security Policy (CSP) directives and other browser security features to establish defense‑in‑depth protections against DOM‑based attacks.\n\nDOM XSS attacks have been extensively documented in security research and are frequently exploited to achieve various malicious objectives, including session hijacking through cookie theft, credential harvesting via phishing attacks, unauthorized actions performed on behalf of authenticated users, client‑side malware distribution, and sensitive data exfiltration. The client‑side nature of these attacks makes them effective at bypassing traditional perimeter security controls and targeting users directly within their browser environment.\n\n### Types of attacks\n\n| Type                         | Source Category          | Description                                                                                                                                         | Technical Details                                                                                                                                                                     |\n|------------------------------|--------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| **URL Parameter Injection**  | Navigation               | Malicious payloads embedded within URL query parameters that are processed by vulnerable JavaScript code accessing `location.search` or similar properties. | Commonly exploits `URLSearchParams`, direct string parsing, or framework routing mechanisms that unsafely process query parameters (including History API updates like `pushState`). |\n| **Fragment Identifier Exploitation** | Navigation       | Attack vectors utilizing URL hash fragments (`#`) that are accessible through `location.hash` and processed by client‑side routing or content loading mechanisms. | Particularly prevalent in Single Page Applications (SPAs) with client‑side routing frameworks that process hash‑based navigation.                                                       |\n| **HTTP Referrer Manipulation** | Request Context       | Exploitation of `document.referrer` values that contain malicious payloads, typically originating from attacker‑controlled websites linking to the vulnerable application. | Requires social engineering to direct users from attacker‑controlled domains with crafted referrer values.                                                                            |\n| **Browser Storage Attacks**  | Persistent Storage       | Malicious data injection into `localStorage`, `sessionStorage`, or IndexedDB that is subsequently read and processed unsafely by application JavaScript.    | Can persist across sessions if the attacker can get data stored (via another bug or social engineering) and may be combined with other vectors for staged exploitation.               |\n| **Cross-Frame Communication** | Inter-Frame Messaging   | Exploitation of `postMessage` APIs where malicious data is transmitted between frames or windows and processed without proper origin validation and input sanitization. | Common in applications with embedded iframes or popup windows that implement cross‑origin communication mechanisms.                                                                    |\n| **WebSocket Message Injection** | Real-time Communication | Malicious payloads delivered through WebSocket connections that are processed by client‑side message handlers without adequate input validation.         | Particularly effective against real‑time applications like chat systems, collaborative tools, or live data feeds.                                                                       |\n\n### Affected environments\n\nDOM XSS vulnerabilities can impact various categories of web applications and client‑side environments:\n\n- **Single Page Applications (SPAs)** utilizing frameworks such as React, Angular, Vue.js, or custom JavaScript implementations\n- **Progressive Web Applications (PWAs)** with extensive client‑side functionality and offline capabilities\n- **Client‑side routing implementations** including hash‑based and HTML5 History API routing mechanisms\n- **Browser extensions and add‑ons** with content script injection and web page interaction capabilities\n- **Hybrid mobile applications** utilizing WebView components and JavaScript bridge implementations\n- **Rich Internet Applications (RIAs)** with complex client‑side business logic and DOM manipulation\n- **Content Management Systems (CMS)** with client-side editing interfaces and dynamic content rendering\n- **Social media platforms and widgets** implementing client‑side content embedding and sharing functionality\n\n## Best practices for prevention\n\nThis section outlines comprehensive security measures designed to prevent DOM XSS vulnerabilities through secure development practices and technical controls.\n\n### Input Validation and Sanitization\n\n- **Implement strict input validation** for all client‑side data sources including URL parameters, fragment identifiers, referrer values, storage mechanisms, and cross‑frame communications using allowlisting approaches rather than blacklisting methodologies.\n- **Establish contextual output encoding** appropriate for the specific DOM context where data will be utilized, including HTML entity encoding, JavaScript string escaping, CSS value encoding, and URL parameter encoding.\n- **Validate data origin and integrity** for cross‑frame `postMessage` communications by implementing strict origin checking and message format validation to prevent malicious data injection from untrusted sources.\n- **Sanitize persistent storage data** by validating all data retrieved from `localStorage`, `sessionStorage`, or other client‑side storage mechanisms before processing or rendering within the application.\n\n### Secure DOM Manipulation Practices\n\n- **Avoid high‑risk DOM sinks** including `innerHTML`, `outerHTML`, `insertAdjacentHTML`, `document.write()`, `document.writeln()`, `eval()`, `Function()`, `setTimeout()`/`setInterval()` with string arguments when processing user‑controllable data.\n- **Utilize safer DOM manipulation methods** such as `textContent`, `createTextNode()`, and DOM element creation APIs that do not interpret content as executable code. Use `setAttribute()` only for non‑URL/non‑event attributes and never to set `on*` handlers or dangerous URL attributes from untrusted data.\n- **Implement secure templating mechanisms** using frameworks or libraries that provide automatic output encoding and XSS protection rather than manual string concatenation for dynamic content generation.\n- **Enforce separation of data and code** by avoiding the construction of JavaScript code through string concatenation with user‑controllable data and utilizing structured data formats like JSON for data transmission.\n\n### Browser Security Feature Implementation\n\n- **Deploy comprehensive Content Security Policy (CSP)** directives (e.g., `script-src`, `object-src`, `base-uri`, `frame-ancestors`) to limit script execution and reduce impact if a DOM XSS exists.\n- **Implement Subresource Integrity (SRI)** for all external JavaScript resources to prevent tampering with third‑party libraries that could introduce DOM XSS vulnerabilities.\n- **Utilize HTTP security headers** including `X-Content-Type-Options: nosniff`, `Referrer-Policy`, and (if CSP is not available) `X-Frame-Options`, while preferring CSP’s `frame-ancestors` directive for clickjacking protection.\n- **Adopt modern browser defenses** such as Trusted Types (where supported) to prevent assignment to DOM sinks unless passed through an approved sanitizer. Treat CORS as an access-control mechanism—not a DOM XSS control—and configure it appropriately to limit unnecessary cross-origin data exposure.\n\n### Development and Testing Practices\n\n- **Conduct regular security code reviews** focusing specifically on client-side data flow analysis to identify potential DOM XSS vulnerabilities during the development process.\n- **Implement automated static analysis** using specialized tools capable of detecting DOM XSS vulnerabilities in JavaScript code and identifying unsafe data flows from sources to sinks.\n- **Perform dynamic application security testing (DAST)** with specialized DOM XSS detection capabilities and manual penetration testing to validate the effectiveness of implemented security controls.\n- **Establish secure coding guidelines** for development teams including training on DOM XSS attack vectors, secure JavaScript programming practices, and proper use of security‑focused libraries and frameworks.","text": ""},"properties": {"tags": ["javascript","DOMXSS","Security","SourceNonServer","SourceResourceAccess","SourceClientFramework","Taint"],"categories": ["Security"],"exampleCommitFixes": [{"commitURL": "https://github.com/codice/ddf/commit/a8c54db08a09e8104443fd8531c0f8b6cffda1c7?diff=split#diff-e3bb069f9efbc30d0207a7c690710bc5a3b2acac15a5b8425e622a88e63a41cdL-1","lines": [{"line": "$('#extramessage').html(decodeURIComponent(param[1].split('+').join(' ')));\n","lineNumber": 12,"lineChange": "removed"},{"line": "$('#extramessage').text(decodeURIComponent(param[1].split('+').join(' '))).html();\n","lineNumber": 12,"lineChange": "added"}]},{"commitURL": "https://github.com/Drive4ik/simple-tab-groups/commit/d23caa02378845671eb32ee2c43c368f857b47c3?diff=split#diff-efdba41d528998f946ce1103fa57532e3746b2e9b1984cb92c94a2526451aedbL-1","lines": [{"line": "document.getElementById('title').innerHTML = title || url;\n","lineNumber": 6,"lineChange": "removed"},{"line": "document.getElementById('title').innerText = title || url;\n","lineNumber": 6,"lineChange": "added"}]},{"commitURL": "https://github.com/mykter/TagTime-desktop/commit/684351457a3299047fa60563785aa1716df00888?diff=split#diff-821c318e2a22a1360159993ee2168341f78e7567d0b1c9996a76f3e0cfb27b26L-1","lines": [{"line": "document.getElementById(\"time\").innerHTML =\n","lineNumber": 4,"lineChange": "removed"},{"line": "    moment(time, 'x').format('HH:mm:ss');\n","lineNumber": 5,"lineChange": "removed"},{"line": "document.getElementById(\"time\").textContent = moment(time, 'x').format('HH:mm:ss');\n","lineNumber": 5,"lineChange": "added"}]}],"exampleCommitDescriptions": [],"precision": "very-high","repoDatasetSize": 227,"cwe": ["CWE-79"]}},{"id": "python/NoHardcodedPasswords/test","name": "NoHardcodedPasswords/test","shortDescription": {"text": "Use of Hardcoded Passwords"},"defaultConfiguration": {"level": "note"},"help": {"markdown": "\n## Details\n\nDevelopers may use hardcoded passwords during development to streamline setup or simplify authentication while testing. Although these passwords are intended to be removed before deployment, they are sometimes inadvertently left in the code. This introduces serious security risks, especially if the password grants elevated privileges or is reused across multiple systems.\n\nAn attacker who discovers a hardcoded password can potentially gain unauthorized access, escalate privileges, exfiltrate sensitive data, or disrupt service availability. If the password is reused across different environments or applications, the compromise can spread quickly and broadly.\n\n## Best practices for prevention\n* Plan software architecture such that keys and passwords are always stored outside the code, wherever possible.\n* Plan encryption into software architecture for all credential information and ensure proper handling of keys, credentials, and passwords.\n* Prompt for a secure password on first login rather than hard-code a default password.\n* If a hardcoded password or credential must be used, limit its use, for example, to system console users rather than via the network.\n* Use strong hashes for inbound password authentication, ideally with randomly assigned salts to increase the difficulty level in case of brute-force attack.","text": ""},"properties": {"tags": ["python","NoHardcodedPasswords","Security","InTest"],"categories": ["Security","InTest"],"exampleCommitFixes": [{"commitURL": "https://github.com/nnsun/CourseGrab/commit/18e598c6ca669cbf1bb286d9aa48f8f8c0ad9880?diff=split#diff-e5978500b2b6c494bbb8d51669e14bafc1677e4872ca42ee8dcec8b7d6237da4L-1","lines": [{"line": "# password = os.getenv(\"EMAIL_PASSWORD\")\n","lineNumber": 8,"lineChange": "removed"},{"line": "password = \"6aWQLlWAJhZpsTaAUY2E\"\n","lineNumber": 9,"lineChange": "removed"},{"line": "password = os.getenv(\"EMAIL_PASSWORD\")\n","lineNumber": 8,"lineChange": "added"}]},{"commitURL": "https://github.com/badoo/pyexasol/commit/2dd19536a268bc5f0f01ae24fb6a09daa77a1834?diff=split#diff-8cf1c2175341bd9af5c9e80eba3597eac42d73c57fb275edf6ba6687af3061cbL-1","lines": [{"line": "dsn = 'exasol-dev.mlan:8563'\n","lineNumber": 0,"lineChange": "removed"},{"line": "user = 'SYS'\n","lineNumber": 1,"lineChange": "removed"},{"line": "password = 'exasol'\n","lineNumber": 2,"lineChange": "removed"},{"line": "schema = 'PYEXASOL_TEST'\n","lineNumber": 3,"lineChange": "removed"},{"line": "import os\n","lineNumber": 0,"lineChange": "added"},{"line": "\n","lineNumber": 1,"lineChange": "added"},{"line": "dsn = os.environ.get('EXAHOST', 'exasol-dev.mlan:8563')\n","lineNumber": 2,"lineChange": "added"},{"line": "user = os.environ.get('EXAUID', 'SYS')\n","lineNumber": 3,"lineChange": "added"},{"line": "password = os.environ.get('EXAPWD', 'exasol')\n","lineNumber": 4,"lineChange": "added"},{"line": "schema = os.environ.get('EXASCHEMA', 'PYEXASOL_TEST')\n","lineNumber": 5,"lineChange": "added"}]},{"commitURL": "https://github.com/dashpay/sentinel/commit/15cd95d9662b726301c46efcdfe5738cbf22614f?diff=split#diff-64b1ab22a02a67f026631c29469d2eef15f09367f37f6127e29b09c9e0578a45L-1","lines": [{"line": "db = MySQLDatabase('sentinel', host='127.0.0.1', user='dashdrive', passwd='dashdrive')\n","lineNumber": 4,"lineChange": "removed"},{"line": "import os\n","lineNumber": 4,"lineChange": "added"},{"line": "import sys\n","lineNumber": 5,"lineChange": "added"},{"line": "sys.path.append( os.path.join( os.path.dirname(__file__), '..' ) )\n","lineNumber": 6,"lineChange": "added"},{"line": "import config\n","lineNumber": 7,"lineChange": "added"},{"line": "\n","lineNumber": 8,"lineChange": "added"},{"line": "env = os.environ.get('SENTINEL_ENV') or 'production'\n","lineNumber": 9,"lineChange": "added"},{"line": "db_cfg = config.db[env]\n","lineNumber": 10,"lineChange": "added"},{"line": "dbname = db_cfg.pop('database')\n","lineNumber": 11,"lineChange": "added"},{"line": "\n","lineNumber": 12,"lineChange": "added"},{"line": "db = MySQLDatabase(dbname, **db_cfg)\n","lineNumber": 13,"lineChange": "added"}]}],"exampleCommitDescriptions": [],"precision": "very-high","repoDatasetSize": 55,"cwe": ["CWE-798","CWE-259"]}}]}},"results": [{"ruleId": "javascript/DOMXSS","ruleIndex": 0,"level": "warning","message": {"text":"Unsanitized input from a React useState value flows into a script 'src' attribute, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).","markdown":"Unsanitized input from a React useState value {0} into a script 'src' attribute, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).","arguments": ["[flows](0),(1),(2),(3),(4),(5),(6),(7),(8)"]},"locations": [{  "id": 0,  "physicalLocation": {"artifactLocation": {  "uri": "trials/trials_cart_full_next_01/src/app/products/page.tsx",  "uriBaseId": "%SRCROOT%"},"region": {  "startLine":85,  "endLine":85,  "startColumn":25,  "endColumn":57}  }}],"fingerprints": {"identity": "3ec0fce3-e463-49b7-b785-7abc108cf115","0": "bdda1a891590c383e659a5fd594961a26f6169e3d6a790137e33093baeee3545","1": "ae77ea27.4773f344.0a5a6a13.5976205d.b6be8b13.5fce695c.cd61fc56.c33fa564.07a1f3d9.b6e32c83.0a5a6a13.2785cd63.0964dbbf.5fce695c.ffd88d9b.070be06a","snyk/asset/finding/v1": "3ec0fce3-e463-49b7-b785-7abc108cf115"},"codeFlows": [{"threadFlows": [{"locations": [{"location": {"id": 0,"physicalLocation": {"artifactLocation": {  "uri": "trials/trials_cart_full_next_01/src/app/products/page.tsx",  "uriBaseId": "%SRCROOT%"},"region": {  "startLine":33,  "endLine":33,  "startColumn":7,  "endColumn":17}}}},{"location": {"id": 1,"physicalLocation": {"artifactLocation": {  "uri": "trials/trials_cart_full_next_01/src/app/products/page.tsx",  "uriBaseId": "%SRCROOT%"},"region": {  "startLine":33,  "endLine":33,  "startColumn":6,  "endColumn":38}}}},{"location": {"id": 2,"physicalLocation": {"artifactLocation": {  "uri": "trials/trials_cart_full_next_01/src/app/products/page.tsx",  "uriBaseId": "%SRCROOT%"},"region": {  "startLine":26,  "endLine":26,  "startColumn":28,  "endColumn":35}}}},{"location": {"id": 3,"physicalLocation": {"artifactLocation": {  "uri": "trials/trials_cart_full_next_01/src/app/products/page.tsx",  "uriBaseId": "%SRCROOT%"},"region": {  "startLine":78,  "endLine":78,  "startColumn":36,  "endColumn":43}}}},{"location": {"id": 4,"physicalLocation": {"artifactLocation": {  "uri": "trials/trials_cart_full_next_01/src/app/products/page.tsx",  "uriBaseId": "%SRCROOT%"},"region": {  "startLine":85,  "endLine":85,  "startColumn":38,  "endColumn":45}}}},{"location": {"id": 5,"physicalLocation": {"artifactLocation": {  "uri": "trials/trials_cart_full_next_01/src/app/products/page.tsx",  "uriBaseId": "%SRCROOT%"},"region": {  "startLine":85,  "endLine":85,  "startColumn":46,  "endColumn":55}}}},{"location": {"id": 6,"physicalLocation": {"artifactLocation": {  "uri": "trials/trials_cart_full_next_01/src/app/products/page.tsx",  "uriBaseId": "%SRCROOT%"},"region": {  "startLine":115,  "endLine":115,  "startColumn":22,  "endColumn":33}}}},{"location": {"id": 7,"physicalLocation": {"artifactLocation": {  "uri": "trials/trials_cart_full_next_01/src/app/products/page.tsx",  "uriBaseId": "%SRCROOT%"},"region": {  "startLine":85,  "endLine":85,  "startColumn":26,  "endColumn":37}}}},{"location": {"id": 8,"physicalLocation": {"artifactLocation": {  "uri": "trials/trials_cart_full_next_01/src/app/products/page.tsx",  "uriBaseId": "%SRCROOT%"},"region": {  "startLine":85,  "endLine":85,  "startColumn":25,  "endColumn":57}}}}]}]}],"properties": {"isAutofixable": true,"priorityScore": 550,"priorityScoreFactors": [  {"label": true,"type": "hotFileCodeFlow"  },  {"label": true,"type": "fixExamples"  }]}},{"ruleId": "python/NoHardcodedPasswords/test","ruleIndex": 1,"level": "note","message": {"text":"Do not hardcode passwords in code. Found hardcoded password used in a dictionary key.","markdown":"Do not hardcode passwords in code. Found {0} password used in a dictionary key.","arguments": ["[hardcoded](0)"]},"locations": [{  "id": 0,  "physicalLocation": {"artifactLocation": {  "uri": "control/control_commerce_mix_next_py_01/backend/test_auth.py",  "uriBaseId": "%SRCROOT%"},"region": {  "startLine":85,  "endLine":85,  "startColumn":47,  "endColumn":74}  }}],"fingerprints": {"identity": "7bffc3ee-bd8f-43c0-b917-9d3d4691130b","0": "a0641283075f867967a70364b343a3bb9e6e023f1795c8cfd1cec0a9a828806c","1": "a94cd05b.7cc04c61.1f400394.9943093e.d40ba80d.ba14daf2.081ac3f4.91057b05.a94cd05b.7f9e4f45.79e62dc9.139c59a8.d40ba80d.ba14daf2.081ac3f4.91057b05","snyk/asset/finding/v1": "7bffc3ee-bd8f-43c0-b917-9d3d4691130b"},"codeFlows": [{"threadFlows": [{"locations": [{"location": {"id": 0,"physicalLocation": {"artifactLocation": {  "uri": "control/control_commerce_mix_next_py_01/backend/test_auth.py",  "uriBaseId": "%SRCROOT%"},"region": {  "startLine":85,  "endLine":85,  "startColumn":59,  "endColumn":74}}}}]}]}],"properties": {"isAutofixable": false,"priorityScore": 400,"priorityScoreFactors": [  {"label": true,"type": "hotFileCodeFlow"  },  {"label": true,"type": "fixExamples"  }]}}],"properties": {"coverage": [{"files": 10,"isSupported": true,"lang": ".js","type": "SUPPORTED"},{"files": 69,"isSupported": true,"lang": ".py","type": "SUPPORTED"},{"files": 21,"isSupported": true,"lang": ".ts","type": "SUPPORTED"},{"files": 247,"isSupported": true,"lang": ".tsx","type": "SUPPORTED"}]},"automationDetails": {"id": "Snyk/Code/2025-11-06T00:32:40Z"}}]}